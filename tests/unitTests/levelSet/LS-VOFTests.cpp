#include <petsc.h>
#include <memory>
#include "MpiTestFixture.hpp"
#include "PetscTestErrorChecker.hpp"
#include "environment/runEnvironment.hpp"
#include "gtest/gtest.h"
#include "levelSet/LS-VOF.hpp"
#include "utilities/petscUtilities.hpp"

using namespace ablate;

struct LSVOFTestFixture_Parameters {
    std::vector<PetscReal> coords;                                                                                                      // Coordinates of the cell vertices
    PetscReal trueCellAreaVol;                                                                                                          // Area/Volume of the cell
    PetscReal trueVOF;                                                                                                                  // The actual VOF for the particular test
    PetscReal trueLengthArea;                                                                                                           // The true length (2D) or area (3D) of the VOF front
    std::vector<PetscReal> c;                                                                                                           // Level-set values at the cell vertices
    void (*vofFunc)(const PetscReal coords[], const PetscReal c[], PetscReal *vof, PetscReal *faceLengthArea, PetscReal *cellAreaVol);  // The function to test
};

class LSVOFTestFixture : public ::testing::TestWithParam<LSVOFTestFixture_Parameters> {};

// Tests the radial functions RBFVal and RBFDer, which returns the function value between two locations and the derivative at a location, respectively.
TEST_P(LSVOFTestFixture, CheckLSFunctions) {
    auto testingParam = GetParam();
    std::vector<PetscReal> coords = testingParam.coords;
    std::vector<PetscReal> c = testingParam.c;
    PetscReal vof, faceLengthArea, cellAreaVol;

    testingParam.vofFunc(coords.data(), c.data(), &vof, &faceLengthArea, &cellAreaVol);

    EXPECT_DOUBLE_EQ(testingParam.trueVOF, vof);
    EXPECT_DOUBLE_EQ(testingParam.trueLengthArea, faceLengthArea);
    EXPECT_DOUBLE_EQ(testingParam.trueCellAreaVol, cellAreaVol);
}

INSTANTIATE_TEST_SUITE_P(
    LevelSetTests, LSVOFTestFixture,
    testing::Values(
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {1.0, 2.0}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {-1.0, -2.0}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 0.5, .trueLengthArea = 0.0, .c = {-0.5, 0.5}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 1.0 / 3.0, .trueLengthArea = 0.0, .c = {-0.1, 0.2}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 2.0 / 3.0, .trueLengthArea = 0.0, .c = {0.1, -0.2}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 1.0 / 3.0, .trueLengthArea = 0.0, .c = {0.2, -0.1}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {-0.1, 0.2}, .trueCellAreaVol = 0.3, .trueVOF = 2.0 / 3.0, .trueLengthArea = 0.0, .c = {-0.2, 0.1}, .vofFunc = &VOF_1D},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {-1.0, -1.0, -1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {1.0, 1.0, 1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0},
                                      .trueCellAreaVol = 5.0 / 4.0,
                                      .trueVOF = 1.0 / 6.0,
                                      .trueLengthArea = PetscSqrtReal(305.0) / 12.0,
                                      .c = {-1.0, 2.0, 1.0},
                                      .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0},
                                      .trueCellAreaVol = 5.0 / 4.0,
                                      .trueVOF = 5.0 / 6.0,
                                      .trueLengthArea = PetscSqrtReal(305.0) / 12.0,
                                      .c = {1.0, -2.0, -1.0},
                                      .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){
            .coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 4.0 / 9.0, .trueLengthArea = 5.0 / 3.0, .c = {1.0, -2.0, 1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){
            .coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 5.0 / 9.0, .trueLengthArea = 5.0 / 3.0, .c = {-1.0, 2.0, -1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){
            .coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 1.0 / 6.0, .trueLengthArea = 5.0 / 12.0, .c = {1.0, 2.0, -1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){
            .coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 5.0 / 6.0, .trueLengthArea = 5.0 / 12.0, .c = {-1.0, -2.0, 1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {0.0, 0.0, -1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {0.0, 0.0, 1.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {0.0, -1.0, 0.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {0.0, 1.0, 0.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {-1.0, 0.0, 0.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){.coords = {0.5, 0.0, 1.0, 1.0, -2.0, 0.0}, .trueCellAreaVol = 5.0 / 4.0, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {1.0, 0.0, 0.0}, .vofFunc = &VOF_2D_Tri},
        (LSVOFTestFixture_Parameters){
            .coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0}, .trueCellAreaVol = 13.0 / 2.0, .trueVOF = 0.0, .trueLengthArea = 0.0, .c = {1.0, 1.0, 1.0, 1.0}, .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){
            .coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0}, .trueCellAreaVol = 13.0 / 2.0, .trueVOF = 1.0, .trueLengthArea = 0.0, .c = {-1.0, -1.0, -1.0, -1.0}, .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 9.0 / 832.0,
                                      .trueLengthArea = 9.0 / 16.0,
                                      .c = {-0.25, 15.0 / 4.0, 11.0 / 4.0, 0.25},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 823.0 / 832.0,
                                      .trueLengthArea = 9.0 / 16.0,
                                      .c = {0.25, -15.0 / 4.0, -11.0 / 4.0, -0.25},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 82.0 / 273.0,
                                      .trueLengthArea = 38.0 * PetscSqrtReal(2.0) / 21.0,
                                      .c = {-2.0, 1.0, 3.0, -0.5},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 191.0 / 273.0,
                                      .trueLengthArea = 38.0 * PetscSqrtReal(2.0) / 21.0,
                                      .c = {2.0, -1.0, -3.0, 0.5},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 161.0 / 260.0,
                                      .trueLengthArea = 33.0 / (10.0 * PetscSqrtReal(2.0)),
                                      .c = {-2.0, 3.0, -1.0, -2.5},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 99.0 / 260.0,
                                      .trueLengthArea = 33.0 / (10.0 * PetscSqrtReal(2.0)),
                                      .c = {2.0, -3.0, 1.0, 2.5},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 1822.0 / 2873.0,
                                      .trueLengthArea = 113.0 * PetscSqrtReal(37.0) / 221.0,
                                      .c = {-1.0, -4.0 / 3.0, 1.5, 1.0 / 12.0},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 4.0, -1.0, 3.0, 2.0, 0.5, 1.0},
                                      .trueCellAreaVol = 13.0 / 2.0,
                                      .trueVOF = 1051.0 / 2873.0,
                                      .trueLengthArea = 113.0 * PetscSqrtReal(37.0) / 221.0,
                                      .c = {1.0, 4.0 / 3.0, -1.5, -1.0 / 12.0},
                                      .vofFunc = &VOF_2D_Quad},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 0.0,
                                      .trueLengthArea = 0.0,
                                      .c = {1.0, 1.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0,
                                      .trueLengthArea = 0.0,
                                      .c = {-1.0, -1.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(89.0) / 32.0,
                                      .c = {1.0, -1.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(89.0) / 32.0,
                                      .c = {-1.0, 1.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(1.5) / 4.0,
                                      .c = {-1.0, 1.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(1.5) / 4.0,
                                      .c = {1.0, -1.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(21.0) / 16.0,
                                      .c = {-1.0, -1.0, 1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0 / 8.0,
                                      .trueLengthArea = PetscSqrtReal(21.0) / 16.0,
                                      .c = {1.0, 1.0, -1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 8.0,
                                      .trueLengthArea = 9.0 / 32.0,
                                      .c = {-1.0, -1.0, -1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0 / 8.0,
                                      .trueLengthArea = 9.0 / 32.0,
                                      .c = {1.0, 1.0, 1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 11.0 / 18.0,
                                      .trueLengthArea = 5.0 * PetscSqrtReal(683.0 / 3.0) / 96.0,
                                      .c = {0.5, 1.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 18.0,
                                      .trueLengthArea = 5.0 * PetscSqrtReal(683.0 / 3.0) / 96.0,
                                      .c = {-0.5, -1.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 11.0 / 18.0,
                                      .trueLengthArea = 5.0 * PetscSqrtReal(41.0) / 96.0,
                                      .c = {0.5, -1.0, 1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 18.0,
                                      .trueLengthArea = 5.0 * PetscSqrtReal(41.0) / 96.0,
                                      .c = {-0.5, 1.0, -1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 11.0 / 18.0,
                                      .trueLengthArea = 25.0 / 32.0,
                                      .c = {0.5, -1.0, -1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 7.0 / 18.0,
                                      .trueLengthArea = 25.0 / 32.0,
                                      .c = {-0.5, 1.0, 1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 0.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, 0.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, 0.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 0.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, 1.0, 0.0, 1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, -1.0, 0.0, -1.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 0.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, 1.0, 1.0, 0.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {0.0, 0.0, 0.0, 2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 2.0, 0.0, 1.0},
                                      .trueCellAreaVol = 5.0 / 12.0,
                                      .trueVOF = 1.0,
                                      .trueLengthArea = 0.0,
                                      .c = {0.0, -1.0, -1.0, 0.0},
                                      .vofFunc = &VOF_3D_Tetra},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 3.0 / 4.0,
                                      .trueLengthArea = 3.0 / PetscSqrtReal(2.0),
                                      .c = {0.0, -2.0, -2.0, 0.0, 1.0, 1.0, -1.0, -1.0},
                                      .vofFunc = &VOF_3D_Hex},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 1.0 / 4.0,
                                      .trueLengthArea = 3.0 / PetscSqrtReal(2.0),
                                      .c = {0.0, 2.0, 2.0, 0.0, -1.0, -1.0, 1.0, 1.0},
                                      .vofFunc = &VOF_3D_Hex},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 1.0 / 8.0,
                                      .trueLengthArea = 1.5,
                                      .c = {-0.5, -0.5, 0.5, 0.5, 0.5, 1.5, 1.5, 0.5},
                                      .vofFunc = &VOF_3D_Hex},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 7.0 / 8.0,
                                      .trueLengthArea = 1.5,
                                      .c = {0.5, 0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -0.5},
                                      .vofFunc = &VOF_3D_Hex},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 9.0 / 512.0,
                                      .trueLengthArea = 27.0 * PetscSqrtReal(5.0) / 128.0,
                                      .c = {5.0 / 4.0, -0.75, 0.25, 9.0 / 4.0, 13.0 / 4.0, 17.0 / 4.0, 9.0 / 4.0, 5.0 / 4.0},
                                      .vofFunc = &VOF_3D_Hex},
        (LSVOFTestFixture_Parameters){.coords = {1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 3.0, 2.0, 3.0, 3.0},
                                      .trueCellAreaVol = 3.0,
                                      .trueVOF = 503.0 / 512.0,
                                      .trueLengthArea = 27.0 * PetscSqrtReal(5.0) / 128.0,
                                      .c = {-5.0 / 4.0, 0.75, -0.25, -9.0 / 4.0, -13.0 / 4.0, -17.0 / 4.0, -9.0 / 4.0, -5.0 / 4.0},
                                      .vofFunc = &VOF_3D_Hex}

        ));
