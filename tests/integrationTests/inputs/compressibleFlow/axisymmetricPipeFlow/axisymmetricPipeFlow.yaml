# Simple flow through an axisymmetric pipe
---
test:
  # a unique test name for this integration tests
  name: axisymmetricPipeFlow
  # create a default assert that compares the log file
  assert: "inputs/domain/meshGeneratorAxisymmetric.txt"

# metadata for the simulation
environment:
  title: _axisymmetricPipeFlow
  tagDirectory: false
# global arguments that can be used by petsc
arguments: []

# set up the time stepper responsible for marching in time
timestepper:
  # write the output to show the mesh
  io:
    interval: 0
  # for this example there are no time stepper arguments (empty simulation)
  arguments: { }
  # create a simple box mesh for simulation
  domain: !ablate::domain::MeshGenerator
    name: exampleAxisymmetricMesh
    # specify the axisymmetric mesh description
    description: !ablate::domain::descriptions::Axisymmetric
      start: [0.0, 0.0, 0.0]
      length: 0.5
      radius: ".1 - .1*z*z"
      numberWedges: 8
      numberSlices: 4
      numberShells: 4
    # output the result label for interior cells
    options:
      dm_label_view: flowRegion
      # force the new mesh to check everything
      dm_plex_check_all: ""

    # specify any modifications to be performed to the mesh/domain
    modifiers:
      - # use the newly  labels to extrude the boundary.  Do not extrude the cell
        !ablate::domain::modifiers::ExtrudeLabel
        regions:
          - name: boundary
        # mark all the resulting boundary faces with boundaryFaces label
        boundaryRegion:
          name: boundaryFaces
        # tag the original mesh as the flow region
        originalRegion:
          name: flowRegion
        # tag the new boundary cells for easy boundary condition specifications
        extrudedRegion:
          name: boundaryCells

      - !ablate::domain::modifiers::DistributeWithGhostCells
        ghostCellDepth: 2

    # setup some dummy fields
    fields:
      - name: exampleFVField
        components: [ "xx"]
        type: FVM

  # initialize the dummy field
  initialization:
    - fieldName: "exampleFVField"
      field: "x"

# this is a test input file with no solvers
solvers: [ ]